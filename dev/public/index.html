<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image to Text Converter</title>
</head>

<body>
    <h1>Hello World</h1>

    <script src='https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js'></script>
    <script>
        fetch('/images', {
            method: 'GET',
            headers: {
                "Content-Type": "application/json",
            },
        }).then(result => result.json()).then(res => {
            res.forEach(createImages);
        })

        function createImages(img) {
            const image = new Image();
                image.src = "/images/" + img;
                document.body.appendChild(image);
        }
    
      recognizeText()

function recognizeText() {
  const div = document.createElement("div");
  Object.assign(div.style, {
    position: "absolute",
    top: 0,
    left: 0,
    height: "4px",
    background: "red",
    width: "0px",
    zIndex: 100,
  });
  document.body.appendChild(div);

  const worker1 = Tesseract.createWorker({
    logger: (m) => {
      const progress = Math.round(m.progress * 100);
      div.style.width = progress + "%";
      console.log(progress);
      if (progress > 99) {
        div.style.display = "none";
      } else [(div.style.display = "initial")];
    },
  });


console.log(worker1);
 ( async () => {
    await worker1.load();
//   await worker1.loadLanguage('eng');
   await worker1.initialize('eng');
    await worker1.recognize(document.querySelector('img'))
  })()

//     .then((e) => {
//         console.log(e);
     
//     worker.terminate();
//   })();
}
    </script>
</body>

</html>